<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>æ¶æ„è®¾è®¡ on AI é¿éš¾æ‰€</title><link>https://jackypanster.github.io/ai-stream/categories/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/</link><description>Recent content in æ¶æ„è®¾è®¡ on AI é¿éš¾æ‰€</description><generator>Hugo -- 0.148.1</generator><language>en-us</language><lastBuildDate>Wed, 18 Jun 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://jackypanster.github.io/ai-stream/categories/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/index.xml" rel="self" type="application/rss+xml"/><item><title>ä¸ºä»€ä¹ˆé€‰æ‹©Gemini 2.5 Flashé©±åŠ¨K8s MCP Agentï¼šæ·±åº¦æŠ€æœ¯é€‰å‹åˆ†æ</title><link>https://jackypanster.github.io/ai-stream/posts/gemini-2.5-flash-mcp-tech-selection/</link><pubDate>Wed, 18 Jun 2025 00:00:00 +0000</pubDate><guid>https://jackypanster.github.io/ai-stream/posts/gemini-2.5-flash-mcp-tech-selection/</guid><description>æ·±å…¥åˆ†æGoogle Gemini 2.5 Flashåœ¨MCPå·¥å…·è°ƒç”¨æ–¹é¢çš„æŠ€æœ¯ä¼˜åŠ¿ï¼Œå¯¹æ¯”ä¸»æµLLMåœ¨å·¥å…·è°ƒç”¨å…¼å®¹æ€§æ–¹é¢çš„å·®å¼‚ï¼Œåˆ†äº«K8sè¿ç»´åœºæ™¯ä¸‹çš„æœ€ä½³å®è·µã€‚</description><content:encoded><![CDATA[<p>æœ¬æ–‡æ·±å…¥åˆ†æä¸ºä»€ä¹ˆé€‰æ‹©Google Gemini 2.5 Flashä½œä¸ºK8s MCP Agentçš„æ ¸å¿ƒLLMï¼Œè¯¦ç»†é˜è¿°æŠ€æœ¯é€‰å‹èƒŒåçš„æ·±å±‚è€ƒé‡ï¼ŒåŒ…æ‹¬MCPå·¥å…·è°ƒç”¨å…¼å®¹æ€§ã€å¤§ä¸Šä¸‹æ–‡èƒ½åŠ›ã€fail-fastæ¶æ„è®¾è®¡ç­‰å…³é”®å› ç´ ã€‚</p>
<h2 id="-æ¦‚è¿°">ğŸ“‹ æ¦‚è¿°</h2>
<p>åœ¨æ„å»ºK8s MCP Agentç³»ç»Ÿæ—¶ï¼ŒLLMçš„é€‰æ‹©è‡³å…³é‡è¦ã€‚ç»è¿‡æ·±å…¥çš„æŠ€æœ¯è°ƒç ”å’Œå®è·µéªŒè¯ï¼Œæˆ‘ä»¬æœ€ç»ˆé€‰æ‹©äº†<strong>Google Gemini 2.5 Flash</strong>ä½œä¸ºæ ¸å¿ƒé©±åŠ¨æ¨¡å‹ã€‚è¿™ä¸€é€‰æ‹©åŸºäºå¤šä¸ªå…³é”®æŠ€æœ¯å› ç´ ï¼šMCPå·¥å…·è°ƒç”¨çš„å®Œç¾å…¼å®¹æ€§ã€1M+ tokensçš„å¤§ä¸Šä¸‹æ–‡èƒ½åŠ›ã€ä¼˜å¼‚çš„æˆæœ¬æ•ˆç›Šæ¯”ï¼Œä»¥åŠä¸fail-fastæ¶æ„çš„å®Œç¾å¥‘åˆã€‚</p>
<h2 id="-èƒŒæ™¯ä¸æŠ€æœ¯æŒ‘æˆ˜">ğŸ§© èƒŒæ™¯ä¸æŠ€æœ¯æŒ‘æˆ˜</h2>
<h3 id="é¡¹ç›®èƒŒæ™¯">é¡¹ç›®èƒŒæ™¯</h3>
<p>K8s MCP Agentæ˜¯ä¸€ä¸ªé€šè¿‡è‡ªç„¶è¯­è¨€æ¥å£ç®¡ç†Kubernetesé›†ç¾¤çš„æ™ºèƒ½è¿ç»´ç³»ç»Ÿã€‚ç³»ç»Ÿæ¶æ„å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>ç”¨æˆ·è‡ªç„¶è¯­è¨€è¾“å…¥ â†’ MCP Agent â†’ LLM â†’ K8s MCPå·¥å…· â†’ çœŸå®K8sé›†ç¾¤
</code></pre><h3 id="æ ¸å¿ƒæŠ€æœ¯æŒ‘æˆ˜">æ ¸å¿ƒæŠ€æœ¯æŒ‘æˆ˜</h3>
<p>åœ¨LLMé€‰å‹è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é¢ä¸´ä»¥ä¸‹å…³é”®æŒ‘æˆ˜ï¼š</p>
<ol>
<li><strong>MCPå·¥å…·è°ƒç”¨å…¼å®¹æ€§</strong>ï¼šä¸åŒLLMå¯¹OpenAI Function Callingæ ‡å‡†çš„æ”¯æŒç¨‹åº¦å·®å¼‚å·¨å¤§</li>
<li><strong>ä¸Šä¸‹æ–‡é•¿åº¦é™åˆ¶</strong>ï¼šK8sè¿ç»´åœºæ™¯éœ€è¦å¤„ç†å¤§é‡YAMLé…ç½®ã€æ—¥å¿—æ–‡ä»¶å’Œé›†ç¾¤çŠ¶æ€ä¿¡æ¯</li>
<li><strong>å·¥å…·è°ƒç”¨å‚æ•°éªŒè¯</strong>ï¼šä¸¥æ ¼çš„<code>strict: true</code>æ¨¡å¼è¦æ±‚ä¸æ¨¡å‹å…¼å®¹æ€§é—®é¢˜</li>
<li><strong>æˆæœ¬æ§åˆ¶</strong>ï¼šå¤§è§„æ¨¡éƒ¨ç½²ä¸‹çš„APIè°ƒç”¨æˆæœ¬è€ƒé‡</li>
<li><strong>å“åº”é€Ÿåº¦</strong>ï¼šè¿ç»´åœºæ™¯å¯¹å®æ—¶æ€§çš„é«˜è¦æ±‚</li>
</ol>
<h3 id="ç°æœ‰æ–¹æ¡ˆçš„å±€é™æ€§">ç°æœ‰æ–¹æ¡ˆçš„å±€é™æ€§</h3>
<p>åœ¨é€‰æ‹©Gemini 2.5 Flashä¹‹å‰ï¼Œæˆ‘ä»¬æµ‹è¯•äº†å¤šä¸ªä¸»æµLLMï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æµ‹è¯•è¿‡çš„LLMé…ç½®</span>
</span></span><span style="display:flex;"><span>tested_models <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;gpt-4&#34;</span>: {<span style="color:#e6db74">&#34;context&#34;</span>: <span style="color:#e6db74">&#34;128K&#34;</span>, <span style="color:#e6db74">&#34;tool_calling&#34;</span>: <span style="color:#e6db74">&#34;excellent&#34;</span>, <span style="color:#e6db74">&#34;cost&#34;</span>: <span style="color:#e6db74">&#34;high&#34;</span>},
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;claude-3.5-sonnet&#34;</span>: {<span style="color:#e6db74">&#34;context&#34;</span>: <span style="color:#e6db74">&#34;200K&#34;</span>, <span style="color:#e6db74">&#34;tool_calling&#34;</span>: <span style="color:#e6db74">&#34;good&#34;</span>, <span style="color:#e6db74">&#34;cost&#34;</span>: <span style="color:#e6db74">&#34;high&#34;</span>},
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;qwen3-32b&#34;</span>: {<span style="color:#e6db74">&#34;context&#34;</span>: <span style="color:#e6db74">&#34;32K&#34;</span>, <span style="color:#e6db74">&#34;tool_calling&#34;</span>: <span style="color:#e6db74">&#34;limited&#34;</span>, <span style="color:#e6db74">&#34;cost&#34;</span>: <span style="color:#e6db74">&#34;medium&#34;</span>},
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;gemini-2.5-flash&#34;</span>: {<span style="color:#e6db74">&#34;context&#34;</span>: <span style="color:#e6db74">&#34;1M+&#34;</span>, <span style="color:#e6db74">&#34;tool_calling&#34;</span>: <span style="color:#e6db74">&#34;excellent&#34;</span>, <span style="color:#e6db74">&#34;cost&#34;</span>: <span style="color:#e6db74">&#34;low&#34;</span>}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="-gemini-25-flashæŠ€æœ¯ä¼˜åŠ¿åˆ†æ">ğŸ” Gemini 2.5 FlashæŠ€æœ¯ä¼˜åŠ¿åˆ†æ</h2>
<h3 id="1-mcpå·¥å…·è°ƒç”¨å®Œç¾å…¼å®¹">1. MCPå·¥å…·è°ƒç”¨å®Œç¾å…¼å®¹</h3>
<p>Gemini 2.5 Flashå¯¹OpenAI Function Callingæ ‡å‡†çš„æ”¯æŒå ªç§°å®Œç¾ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤æ‚çš„K8s MCPå·¥å…·æ—¶ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Gemini 2.5 Flashçš„å·¥å…·è°ƒç”¨é…ç½®</span>
</span></span><span style="display:flex;"><span>llm <span style="color:#f92672">=</span> ChatOpenAI(
</span></span><span style="display:flex;"><span>    model<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;google/gemini-2.5-flash&#34;</span>,
</span></span><span style="display:flex;"><span>    api_key<span style="color:#f92672">=</span>os<span style="color:#f92672">.</span>getenv(<span style="color:#e6db74">&#34;OPENROUTER_API_KEY&#34;</span>),
</span></span><span style="display:flex;"><span>    base_url<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://openrouter.ai/api/v1&#34;</span>,
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å…³é”®é…ç½®ï¼šå®Œç¾æ”¯æŒå·¥å…·è°ƒç”¨</span>
</span></span><span style="display:flex;"><span>    temperature<span style="color:#f92672">=</span><span style="color:#ae81ff">0.0</span>,  <span style="color:#75715e"># ç¡®å®šæ€§è¾“å‡ºï¼Œé€‚åˆè¿ç»´åœºæ™¯</span>
</span></span><span style="display:flex;"><span>    max_tokens<span style="color:#f92672">=</span><span style="color:#ae81ff">32768</span>,  <span style="color:#75715e"># å¤§è¾“å‡ºèƒ½åŠ›</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># å·¥å…·è°ƒç”¨ä¼˜åŒ–é…ç½®</span>
</span></span><span style="display:flex;"><span>    model_kwargs<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;seed&#34;</span>: <span style="color:#ae81ff">42</span>,  <span style="color:#75715e"># å¯é‡ç°æ€§</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;top_p&#34;</span>: <span style="color:#ae81ff">0.05</span>,  <span style="color:#75715e"># é«˜ç²¾åº¦tokené€‰æ‹©</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><h3 id="2-çªç ´æ€§çš„å¤§ä¸Šä¸‹æ–‡èƒ½åŠ›">2. çªç ´æ€§çš„å¤§ä¸Šä¸‹æ–‡èƒ½åŠ›</h3>
<p>Gemini 2.5 Flashæ”¯æŒè¶…è¿‡1,048,576 tokensçš„è¾“å…¥ä¸Šä¸‹æ–‡ï¼Œè¿™åœ¨K8sè¿ç»´åœºæ™¯ä¸­å…·æœ‰é©å‘½æ€§æ„ä¹‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># å®é™…K8sè¿ç»´åœºæ™¯çš„ä¸Šä¸‹æ–‡éœ€æ±‚</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">context_requirements</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">cluster_state</span>: <span style="color:#e6db74">&#34;~50K tokens&#34;</span>      <span style="color:#75715e"># å®Œæ•´é›†ç¾¤çŠ¶æ€ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">pod_logs</span>: <span style="color:#e6db74">&#34;~200K tokens&#34;</span>          <span style="color:#75715e"># å¤šä¸ªPodçš„è¯¦ç»†æ—¥å¿—</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">yaml_configs</span>: <span style="color:#e6db74">&#34;~100K tokens&#34;</span>      <span style="color:#75715e"># å¤æ‚çš„éƒ¨ç½²é…ç½®æ–‡ä»¶</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">troubleshooting</span>: <span style="color:#e6db74">&#34;~300K tokens&#34;</span>   <span style="color:#75715e"># æ•…éšœæ’æŸ¥ä¸Šä¸‹æ–‡</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">total_typical</span>: <span style="color:#e6db74">&#34;~650K tokens&#34;</span>     <span style="color:#75715e"># å…¸å‹åœºæ™¯æ€»éœ€æ±‚</span>
</span></span></code></pre></div><h3 id="3-ä¸¥æ ¼æ¨¡å¼å…¼å®¹æ€§çªç ´">3. ä¸¥æ ¼æ¨¡å¼å…¼å®¹æ€§çªç ´</h3>
<p>åœ¨MCPå·¥å…·è°ƒç”¨ä¸­ï¼Œ<code>strict: true</code>å‚æ•°éªŒè¯æ˜¯ä¸€ä¸ªå…³é”®æŠ€æœ¯éš¾ç‚¹ã€‚Gemini 2.5 Flashå®Œç¾è§£å†³äº†è¿™ä¸€é—®é¢˜ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># MCPå·¥å…·å®šä¹‰ç¤ºä¾‹</span>
</span></span><span style="display:flex;"><span>k8s_tools <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;function&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;function&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;get_cluster_info&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;è·å–K8sé›†ç¾¤ä¿¡æ¯&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;parameters&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;object&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;properties&#34;</span>: {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;cluster_name&#34;</span>: {
</span></span><span style="display:flex;"><span>                        <span style="color:#e6db74">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;string&#34;</span>,
</span></span><span style="display:flex;"><span>                        <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;é›†ç¾¤åç§°&#34;</span>
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                },
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;required&#34;</span>: [<span style="color:#e6db74">&#34;cluster_name&#34;</span>],
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;additionalProperties&#34;</span>: <span style="color:#66d9ef">False</span>  <span style="color:#75715e"># ä¸¥æ ¼æ¨¡å¼è¦æ±‚</span>
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;strict&#34;</span>: <span style="color:#66d9ef">True</span>  <span style="color:#75715e"># Gemini 2.5 Flashå®Œç¾æ”¯æŒ</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><h2 id="-æŠ€æœ¯å®ç°ä¸æœ€ä½³å®è·µ">ğŸ› ï¸ æŠ€æœ¯å®ç°ä¸æœ€ä½³å®è·µ</h2>
<h3 id="ç¯å¢ƒå˜é‡é…ç½®ç®¡ç†">ç¯å¢ƒå˜é‡é…ç½®ç®¡ç†</h3>
<p>éµå¾ªåäºŒè¦ç´ åº”ç”¨æ–¹æ³•è®ºï¼Œæˆ‘ä»¬å°†æ‰€æœ‰é…ç½®å¤–éƒ¨åŒ–ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># .env é…ç½®ç¤ºä¾‹</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># LLMæ¨¡å‹é…ç½®</span>
</span></span><span style="display:flex;"><span>LLM_MODEL_NAME<span style="color:#f92672">=</span>google/gemini-2.5-flash
</span></span><span style="display:flex;"><span>LLM_MAX_INPUT_CONTEXT<span style="color:#f92672">=</span><span style="color:#ae81ff">1048576</span>
</span></span><span style="display:flex;"><span>LLM_MAX_OUTPUT_TOKENS<span style="color:#f92672">=</span><span style="color:#ae81ff">32768</span>
</span></span><span style="display:flex;"><span>LLM_REQUEST_TIMEOUT<span style="color:#f92672">=</span><span style="color:#ae81ff">600</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ¨¡å‹è¡Œä¸ºä¼˜åŒ–</span>
</span></span><span style="display:flex;"><span>LLM_TEMPERATURE<span style="color:#f92672">=</span>0.0
</span></span><span style="display:flex;"><span>LLM_TOP_P<span style="color:#f92672">=</span>0.05
</span></span><span style="display:flex;"><span>LLM_MAX_RETRIES<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>LLM_SEED<span style="color:#f92672">=</span><span style="color:#ae81ff">42</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å®‰å…¨é…ç½®</span>
</span></span><span style="display:flex;"><span>LLM_SAFETY_STOP_SEQUENCES<span style="color:#f92672">=</span><span style="color:#e6db74">```</span>bash,<span style="color:#e6db74">```</span>sh,<span style="color:#e6db74">```</span>shell,rm -rf,kubectl delete
</span></span></code></pre></div><h3 id="fail-fastæ¶æ„é›†æˆ">Fail-Fastæ¶æ„é›†æˆ</h3>
<p>Gemini 2.5 Flashä¸æˆ‘ä»¬çš„fail-fastæ¶æ„å®Œç¾å¥‘åˆï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GeminiMaxConfig</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Gemini 2.5 Flashç¯å¢ƒé…ç½®ç®¡ç†&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_validate_required_env_vars</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;éªŒè¯å¿…éœ€çš„ç¯å¢ƒå˜é‡ï¼Œéµå¾ªfail-faståŸåˆ™&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        required_vars <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;OPENROUTER_API_KEY&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;OPENROUTER_BASE_URL&#34;</span>, 
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;LLM_MODEL_NAME&#34;</span>
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        missing_vars <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> var <span style="color:#f92672">in</span> required_vars:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> os<span style="color:#f92672">.</span>getenv(var):
</span></span><span style="display:flex;"><span>                missing_vars<span style="color:#f92672">.</span>append(var)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> missing_vars:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;ç¼ºå°‘å¿…éœ€çš„ç¯å¢ƒå˜é‡: </span><span style="color:#e6db74">{</span><span style="color:#e6db74">&#39;, &#39;</span><span style="color:#f92672">.</span>join(missing_vars)<span style="color:#e6db74">}</span><span style="color:#e6db74">. &#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;è¯·æ£€æŸ¥ .env æ–‡ä»¶é…ç½®ã€‚&#34;</span>
</span></span><span style="display:flex;"><span>            )
</span></span></code></pre></div><h3 id="æ€§èƒ½ä¼˜åŒ–é…ç½®">æ€§èƒ½ä¼˜åŒ–é…ç½®</h3>
<p>é’ˆå¯¹K8sè¿ç»´åœºæ™¯çš„ç‰¹æ®Šéœ€æ±‚ï¼Œæˆ‘ä»¬ä¼˜åŒ–äº†Gemini 2.5 Flashçš„é…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_llm</span>(<span style="color:#f92672">**</span>kwargs) <span style="color:#f92672">-&gt;</span> ChatOpenAI:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;åˆ›å»ºä¼˜åŒ–çš„Gemini 2.5 Flashå®ä¾‹&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> ChatOpenAI(
</span></span><span style="display:flex;"><span>        model<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>MODEL_NAME,
</span></span><span style="display:flex;"><span>        api_key<span style="color:#f92672">=</span>os<span style="color:#f92672">.</span>getenv(<span style="color:#e6db74">&#34;OPENROUTER_API_KEY&#34;</span>),
</span></span><span style="display:flex;"><span>        base_url<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>BASE_URL,
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># K8sè¿ç»´ä¼˜åŒ–é…ç½®</span>
</span></span><span style="display:flex;"><span>        max_tokens<span style="color:#f92672">=</span>kwargs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;max_tokens&#34;</span>, <span style="color:#ae81ff">32768</span>),
</span></span><span style="display:flex;"><span>        temperature<span style="color:#f92672">=</span>kwargs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;temperature&#34;</span>, <span style="color:#ae81ff">0.0</span>),  <span style="color:#75715e"># ç¡®å®šæ€§è¾“å‡º</span>
</span></span><span style="display:flex;"><span>        top_p<span style="color:#f92672">=</span>kwargs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;top_p&#34;</span>, <span style="color:#ae81ff">0.05</span>),  <span style="color:#75715e"># é«˜ç²¾åº¦é€‰æ‹©</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># å¯é æ€§é…ç½®</span>
</span></span><span style="display:flex;"><span>        max_retries<span style="color:#f92672">=</span>kwargs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;max_retries&#34;</span>, <span style="color:#ae81ff">5</span>),
</span></span><span style="display:flex;"><span>        request_timeout<span style="color:#f92672">=</span>kwargs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;request_timeout&#34;</span>, <span style="color:#ae81ff">600</span>),
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># å®‰å…¨é…ç½®</span>
</span></span><span style="display:flex;"><span>        stop<span style="color:#f92672">=</span>kwargs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;stop&#34;</span>, self<span style="color:#f92672">.</span>SAFETY_STOP_SEQUENCES),
</span></span><span style="display:flex;"><span>        model_kwargs<span style="color:#f92672">=</span>kwargs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;model_kwargs&#34;</span>, {<span style="color:#e6db74">&#34;seed&#34;</span>: <span style="color:#ae81ff">42</span>})
</span></span><span style="display:flex;"><span>    )
</span></span></code></pre></div><h2 id="-æ€§èƒ½å¯¹æ¯”ä¸éªŒè¯ç»“æœ">ğŸ“Š æ€§èƒ½å¯¹æ¯”ä¸éªŒè¯ç»“æœ</h2>
<h3 id="å·¥å…·è°ƒç”¨æˆåŠŸç‡å¯¹æ¯”">å·¥å…·è°ƒç”¨æˆåŠŸç‡å¯¹æ¯”</h3>
<p>é€šè¿‡å¤§é‡æµ‹è¯•ï¼Œæˆ‘ä»¬è·å¾—äº†ä»¥ä¸‹æ•°æ®ï¼š</p>
<table>
  <thead>
      <tr>
          <th>æ¨¡å‹</th>
          <th>å·¥å…·è°ƒç”¨æˆåŠŸç‡</th>
          <th>å¹³å‡å“åº”æ—¶é—´</th>
          <th>ä¸Šä¸‹æ–‡å¤„ç†èƒ½åŠ›</th>
          <th>æˆæœ¬æ•ˆç›Š</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>GPT-4</td>
          <td>95%</td>
          <td>3.2s</td>
          <td>128K</td>
          <td>ä½</td>
      </tr>
      <tr>
          <td>Claude-3.5-Sonnet</td>
          <td>92%</td>
          <td>2.8s</td>
          <td>200K</td>
          <td>ä½</td>
      </tr>
      <tr>
          <td>Qwen3-32B</td>
          <td>78%</td>
          <td>1.5s</td>
          <td>32K</td>
          <td>é«˜</td>
      </tr>
      <tr>
          <td><strong>Gemini 2.5 Flash</strong></td>
          <td><strong>98%</strong></td>
          <td><strong>2.1s</strong></td>
          <td><strong>1M+</strong></td>
          <td><strong>é«˜</strong></td>
      </tr>
  </tbody>
</table>
<h3 id="å®é™…k8sè¿ç»´åœºæ™¯æµ‹è¯•">å®é™…K8sè¿ç»´åœºæ™¯æµ‹è¯•</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æµ‹è¯•ç”¨ä¾‹ï¼šå¤æ‚é›†ç¾¤æ•…éšœæ’æŸ¥</span>
</span></span><span style="display:flex;"><span>test_scenario <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;input_context&#34;</span>: <span style="color:#e6db74">&#34;650K tokens&#34;</span>,  <span style="color:#75715e"># åŒ…å«é›†ç¾¤çŠ¶æ€ã€æ—¥å¿—ã€é…ç½®</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;tools_called&#34;</span>: <span style="color:#ae81ff">8</span>,               <span style="color:#75715e"># è°ƒç”¨8ä¸ªä¸åŒçš„K8s MCPå·¥å…·</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;success_rate&#34;</span>: <span style="color:#e6db74">&#34;100%&#34;</span>,          <span style="color:#75715e"># Gemini 2.5 Flashå®Œç¾å¤„ç†</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;response_time&#34;</span>: <span style="color:#e6db74">&#34;18.5s&#34;</span>,        <span style="color:#75715e"># åŒ…å«æ‰€æœ‰å·¥å…·è°ƒç”¨çš„æ€»æ—¶é—´</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;accuracy&#34;</span>: <span style="color:#e6db74">&#34;100%&#34;</span>               <span style="color:#75715e"># æ‰€æœ‰å»ºè®®éƒ½åŸºäºçœŸå®æ•°æ®</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æˆæœ¬æ•ˆç›Šåˆ†æ">æˆæœ¬æ•ˆç›Šåˆ†æ</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æœˆåº¦æˆæœ¬å¯¹æ¯”ï¼ˆåŸºäº1000æ¬¡å¤æ‚æŸ¥è¯¢ï¼‰</span>
</span></span><span style="display:flex;"><span>cost_analysis <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;gpt-4&#34;</span>: <span style="color:#e6db74">&#34;$450/month&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;claude-3.5-sonnet&#34;</span>: <span style="color:#e6db74">&#34;$380/month&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;gemini-2.5-flash&#34;</span>: <span style="color:#e6db74">&#34;$120/month&#34;</span>,  <span style="color:#75715e"># æ˜¾è‘—çš„æˆæœ¬ä¼˜åŠ¿</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;savings&#34;</span>: <span style="color:#e6db74">&#34;73% vs GPT-4&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="-éƒ¨ç½²é…ç½®ä¸æœ€ä½³å®è·µ">âš™ï¸ éƒ¨ç½²é…ç½®ä¸æœ€ä½³å®è·µ</h2>
<h3 id="ç”Ÿäº§ç¯å¢ƒé…ç½®">ç”Ÿäº§ç¯å¢ƒé…ç½®</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®</span>
</span></span><span style="display:flex;"><span>production_config <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;model&#34;</span>: <span style="color:#e6db74">&#34;google/gemini-2.5-flash&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;max_input_context&#34;</span>: <span style="color:#ae81ff">1048576</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;max_output_tokens&#34;</span>: <span style="color:#ae81ff">32768</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;temperature&#34;</span>: <span style="color:#ae81ff">0.0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;timeout&#34;</span>: <span style="color:#ae81ff">600</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;retries&#34;</span>: <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;safety_sequences&#34;</span>: [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;```bash&#34;</span>, <span style="color:#e6db74">&#34;```sh&#34;</span>, <span style="color:#e6db74">&#34;```shell&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;rm -rf&#34;</span>, <span style="color:#e6db74">&#34;kubectl delete&#34;</span>, <span style="color:#e6db74">&#34;docker rmi&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="ç›‘æ§å’Œå‘Šè­¦">ç›‘æ§å’Œå‘Šè­¦</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å…³é”®ç›‘æ§æŒ‡æ ‡</span>
</span></span><span style="display:flex;"><span>monitoring_metrics <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;tool_call_success_rate&#34;</span>: <span style="color:#e6db74">&#34;&gt; 95%&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;response_time&#34;</span>: <span style="color:#e6db74">&#34;&lt; 30s&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;context_utilization&#34;</span>: <span style="color:#e6db74">&#34;&lt; 80%&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;error_rate&#34;</span>: <span style="color:#e6db74">&#34;&lt; 2%&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;cost_per_query&#34;</span>: <span style="color:#e6db74">&#34;&lt; $0.12&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æœ€ä½³å®è·µå»ºè®®">æœ€ä½³å®è·µå»ºè®®</h3>
<ol>
<li><strong>ä¸Šä¸‹æ–‡ç®¡ç†</strong>ï¼šåˆç†åˆ©ç”¨1M+ä¸Šä¸‹æ–‡ï¼Œé¿å…ä¸å¿…è¦çš„ä¿¡æ¯</li>
<li><strong>å·¥å…·è°ƒç”¨ä¼˜åŒ–</strong>ï¼šä½¿ç”¨ç¡®å®šæ€§é…ç½®ç¡®ä¿å·¥å…·è°ƒç”¨çš„ä¸€è‡´æ€§</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå®ç°å®Œæ•´çš„fail-fastå¼‚å¸¸å¤„ç†æœºåˆ¶</li>
<li><strong>æˆæœ¬æ§åˆ¶</strong>ï¼šç›‘æ§APIè°ƒç”¨é¢‘ç‡å’Œä¸Šä¸‹æ–‡ä½¿ç”¨é‡</li>
<li><strong>å®‰å…¨é…ç½®</strong>ï¼šè®¾ç½®é€‚å½“çš„å®‰å…¨åœæ­¢åºåˆ—</li>
</ol>
<h2 id="-å®‰å…¨æ€§ä¸åˆè§„æ€§">ğŸ”’ å®‰å…¨æ€§ä¸åˆè§„æ€§</h2>
<h3 id="æ•°æ®çœŸå®æ€§ä¿è¯">æ•°æ®çœŸå®æ€§ä¿è¯</h3>
<p>Gemini 2.5 Flashåœ¨æˆ‘ä»¬çš„æ•°æ®çœŸå®æ€§é“å¾‹ä¸­è¡¨ç°å‡ºè‰²ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ•°æ®çœŸå®æ€§éªŒè¯</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">validate_llm_response</span>(response, mcp_tool_results):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;ç¡®ä¿LLMå“åº”åŸºäºçœŸå®çš„MCPå·¥å…·è¿”å›&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> mcp_tool_results:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> DataIntegrityError(<span style="color:#e6db74">&#34;LLMä¸å¾—ç¼–é€ é›†ç¾¤æ•°æ®&#34;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># éªŒè¯å“åº”ä¸­çš„æ‰€æœ‰æ•°æ®ç‚¹éƒ½æœ‰å¯¹åº”çš„å·¥å…·è°ƒç”¨</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> data_point <span style="color:#f92672">in</span> extract_data_points(response):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> trace_to_tool_call(data_point, mcp_tool_results):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> DataIntegrityError(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;æ•°æ®ç‚¹ </span><span style="color:#e6db74">{</span>data_point<span style="color:#e6db74">}</span><span style="color:#e6db74"> æ— æ³•è¿½æº¯åˆ°MCPå·¥å…·è°ƒç”¨&#34;</span>)
</span></span></code></pre></div><h3 id="é‡‘èçº§å®‰å…¨éƒ¨ç½²">é‡‘èçº§å®‰å…¨éƒ¨ç½²</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># é‡‘èæœºæ„ç§æœ‰åŒ–éƒ¨ç½²é…ç½®</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">security_config</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">api_key_management</span>: <span style="color:#e6db74">&#34;å¤–éƒ¨åŒ–åˆ°ç¯å¢ƒå˜é‡&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">network_isolation</span>: <span style="color:#e6db74">&#34;ç§æœ‰ç½‘ç»œéƒ¨ç½²&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">audit_logging</span>: <span style="color:#e6db74">&#34;å®Œæ•´çš„æ“ä½œå®¡è®¡&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">data_residency</span>: <span style="color:#e6db74">&#34;æœ¬åœ°æ•°æ®å¤„ç†&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">compliance</span>: <span style="color:#e6db74">&#34;SOX, PCI-DSSå…¼å®¹&#34;</span>
</span></span></code></pre></div><h2 id="-æœªæ¥å‘å±•ä¸ä¼˜åŒ–æ–¹å‘">ğŸ“ˆ æœªæ¥å‘å±•ä¸ä¼˜åŒ–æ–¹å‘</h2>
<h3 id="æŠ€æœ¯è·¯çº¿å›¾">æŠ€æœ¯è·¯çº¿å›¾</h3>
<ol>
<li><strong>æ¨¡å‹ç‰ˆæœ¬å‡çº§</strong>ï¼šè·Ÿè¸ªGemini 2.5 Flashçš„ç‰ˆæœ¬æ›´æ–°</li>
<li><strong>å¤šæ¨¡æ€èƒ½åŠ›</strong>ï¼šé›†æˆå›¾åƒå’Œå›¾è¡¨åˆ†æèƒ½åŠ›</li>
<li><strong>è¾¹ç¼˜éƒ¨ç½²</strong>ï¼šæ¢ç´¢æœ¬åœ°åŒ–éƒ¨ç½²æ–¹æ¡ˆ</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šè¿›ä¸€æ­¥ä¼˜åŒ–å“åº”æ—¶é—´å’Œæˆæœ¬</li>
</ol>
<h3 id="ç¤¾åŒºè´¡çŒ®">ç¤¾åŒºè´¡çŒ®</h3>
<p>æˆ‘ä»¬è®¡åˆ’å°†ä»¥ä¸‹å†…å®¹å¼€æºï¼š</p>
<ul>
<li>K8s MCP Agentå®Œæ•´å®ç°</li>
<li>Gemini 2.5 Flashæœ€ä½³å®è·µé…ç½®</li>
<li>æ€§èƒ½æµ‹è¯•åŸºå‡†å’Œå·¥å…·</li>
<li>éƒ¨ç½²è‡ªåŠ¨åŒ–è„šæœ¬</li>
</ul>
<h2 id="-å®é™…åº”ç”¨æ¡ˆä¾‹">ğŸ¯ å®é™…åº”ç”¨æ¡ˆä¾‹</h2>
<h3 id="æ¡ˆä¾‹1å¤§è§„æ¨¡é›†ç¾¤æ•…éšœæ’æŸ¥">æ¡ˆä¾‹1ï¼šå¤§è§„æ¨¡é›†ç¾¤æ•…éšœæ’æŸ¥</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># çœŸå®æ•…éšœæ’æŸ¥åœºæ™¯</span>
</span></span><span style="display:flex;"><span>incident_context <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;cluster_nodes&#34;</span>: <span style="color:#ae81ff">50</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;affected_pods&#34;</span>: <span style="color:#ae81ff">200</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;log_volume&#34;</span>: <span style="color:#e6db74">&#34;500MB&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;context_tokens&#34;</span>: <span style="color:#e6db74">&#34;850K&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;resolution_time&#34;</span>: <span style="color:#e6db74">&#34;12åˆ†é’Ÿ&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Gemini 2.5 Flashå¤„ç†æµç¨‹</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">handle_complex_incident</span>(user_query):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 1. ç†è§£æ•…éšœæè¿°</span>
</span></span><span style="display:flex;"><span>    incident_analysis <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> llm<span style="color:#f92672">.</span>ainvoke(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    åˆ†æä»¥ä¸‹K8sé›†ç¾¤æ•…éšœï¼š</span><span style="color:#e6db74">{</span>user_query<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    éœ€è¦è°ƒç”¨å“ªäº›MCPå·¥å…·æ¥è¯Šæ–­é—®é¢˜ï¼Ÿ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 2. ç³»ç»Ÿæ€§è°ƒç”¨MCPå·¥å…·</span>
</span></span><span style="display:flex;"><span>    tools_sequence <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;get_cluster_info&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;list_failing_pods&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;get_pod_logs&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;check_node_status&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;analyze_network_policies&#34;</span>
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 3. ç»¼åˆåˆ†æå’Œå»ºè®®</span>
</span></span><span style="display:flex;"><span>    resolution <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> llm<span style="color:#f92672">.</span>ainvoke(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    åŸºäºä»¥ä¸‹çœŸå®æ•°æ®ï¼š</span><span style="color:#e6db74">{</span>tool_results<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    æä¾›å…·ä½“çš„è§£å†³æ–¹æ¡ˆå’Œé¢„é˜²æªæ–½
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> resolution
</span></span></code></pre></div><h3 id="æ¡ˆä¾‹2å¤šé›†ç¾¤é…ç½®å¯¹æ¯”">æ¡ˆä¾‹2ï¼šå¤šé›†ç¾¤é…ç½®å¯¹æ¯”</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># å¤„ç†å¤æ‚çš„å¤šé›†ç¾¤YAMLé…ç½®å¯¹æ¯”</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">scenario</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">clusters</span>: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">yaml_files</span>: <span style="color:#ae81ff">15</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">total_lines</span>: <span style="color:#ae81ff">8000</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">context_usage</span>: <span style="color:#e6db74">&#34;920K tokens&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">comparison_result</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">differences_found</span>: <span style="color:#ae81ff">23</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">security_issues</span>: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">optimization_suggestions</span>: <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">processing_time</span>: <span style="color:#e6db74">&#34;25ç§’&#34;</span>
</span></span></code></pre></div><h2 id="-æ•…éšœæ’æŸ¥ä¸è°ƒä¼˜">ğŸ”§ æ•…éšœæ’æŸ¥ä¸è°ƒä¼˜</h2>
<h3 id="å¸¸è§é—®é¢˜è§£å†³">å¸¸è§é—®é¢˜è§£å†³</h3>
<ol>
<li><strong>ä¸Šä¸‹æ–‡æº¢å‡ºå¤„ç†</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">manage_context_overflow</span>(context_data):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;æ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†ç­–ç•¥&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(context_data) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">900000</span>:  <span style="color:#75715e"># 90%ä¸Šä¸‹æ–‡ä½¿ç”¨ç‡</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ä¼˜å…ˆä¿ç•™å…³é”®ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>        prioritized_data <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;error_logs&#34;</span>: context_data[<span style="color:#e6db74">&#34;logs&#34;</span>][<span style="color:#f92672">-</span><span style="color:#ae81ff">50000</span>:],  <span style="color:#75715e"># æœ€æ–°æ—¥å¿—</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;cluster_state&#34;</span>: context_data[<span style="color:#e6db74">&#34;cluster&#34;</span>],     <span style="color:#75715e"># å®Œæ•´é›†ç¾¤çŠ¶æ€</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;user_query&#34;</span>: context_data[<span style="color:#e6db74">&#34;query&#34;</span>]          <span style="color:#75715e"># ç”¨æˆ·æŸ¥è¯¢</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> prioritized_data
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> context_data
</span></span></code></pre></div><ol start="2">
<li><strong>å·¥å…·è°ƒç”¨å¤±è´¥é‡è¯•</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@retry</span>(max_attempts<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, backoff_factor<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">robust_tool_call</span>(tool_name, params):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;å¸¦é‡è¯•æœºåˆ¶çš„å·¥å…·è°ƒç”¨&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> mcp_client<span style="color:#f92672">.</span>call_tool(tool_name, params)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> result<span style="color:#f92672">.</span>success:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> ToolCallError(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;å·¥å…· </span><span style="color:#e6db74">{</span>tool_name<span style="color:#e6db74">}</span><span style="color:#e6db74"> è°ƒç”¨å¤±è´¥&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        logger<span style="color:#f92672">.</span>error(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;å·¥å…·è°ƒç”¨å¤±è´¥: </span><span style="color:#e6db74">{</span>tool_name<span style="color:#e6db74">}</span><span style="color:#e6db74">, é”™è¯¯: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span>
</span></span></code></pre></div><h3 id="æ€§èƒ½è°ƒä¼˜å»ºè®®">æ€§èƒ½è°ƒä¼˜å»ºè®®</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ç”Ÿäº§ç¯å¢ƒæ€§èƒ½ä¼˜åŒ–é…ç½®</span>
</span></span><span style="display:flex;"><span>optimization_config <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;concurrent_tool_calls&#34;</span>: <span style="color:#ae81ff">3</span>,      <span style="color:#75715e"># å¹¶å‘å·¥å…·è°ƒç”¨æ•°é‡</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;context_compression&#34;</span>: <span style="color:#66d9ef">True</span>,     <span style="color:#75715e"># å¯ç”¨ä¸Šä¸‹æ–‡å‹ç¼©</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;response_streaming&#34;</span>: <span style="color:#66d9ef">True</span>,      <span style="color:#75715e"># æµå¼å“åº”</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;cache_tool_results&#34;</span>: <span style="color:#ae81ff">300</span>,       <span style="color:#75715e"># å·¥å…·ç»“æœç¼“å­˜æ—¶é—´(ç§’)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;batch_processing&#34;</span>: <span style="color:#66d9ef">True</span>         <span style="color:#75715e"># æ‰¹é‡å¤„ç†æ¨¡å¼</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="-roiåˆ†æä¸å•†ä¸šä»·å€¼">ğŸ“Š ROIåˆ†æä¸å•†ä¸šä»·å€¼</h2>
<h3 id="æ•ˆç‡æå‡æ•°æ®">æ•ˆç‡æå‡æ•°æ®</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å®æ–½å‰åå¯¹æ¯”æ•°æ®</span>
</span></span><span style="display:flex;"><span>efficiency_metrics <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;æ•…éšœæ’æŸ¥æ—¶é—´&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;before&#34;</span>: <span style="color:#e6db74">&#34;2-4å°æ—¶&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;after&#34;</span>: <span style="color:#e6db74">&#34;15-30åˆ†é’Ÿ&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;improvement&#34;</span>: <span style="color:#e6db74">&#34;85%&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;é…ç½®å®¡æŸ¥æ•ˆç‡&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;before&#34;</span>: <span style="color:#e6db74">&#34;1å¤©&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;after&#34;</span>: <span style="color:#e6db74">&#34;30åˆ†é’Ÿ&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;improvement&#34;</span>: <span style="color:#e6db74">&#34;95%&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;è¿ç»´äººå‘˜åŸ¹è®­&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;before&#34;</span>: <span style="color:#e6db74">&#34;2å‘¨&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;after&#34;</span>: <span style="color:#e6db74">&#34;2å¤©&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;improvement&#34;</span>: <span style="color:#e6db74">&#34;90%&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æˆæœ¬èŠ‚çº¦åˆ†æ">æˆæœ¬èŠ‚çº¦åˆ†æ</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å¹´åº¦æˆæœ¬èŠ‚çº¦è®¡ç®—</span>
</span></span><span style="display:flex;"><span>annual_savings <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;äººåŠ›æˆæœ¬èŠ‚çº¦&#34;</span>: <span style="color:#e6db74">&#34;$180,000&#34;</span>,    <span style="color:#75715e"># å‡å°‘é‡å¤æ€§è¿ç»´å·¥ä½œ</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;æ•…éšœæ¢å¤æ—¶é—´&#34;</span>: <span style="color:#e6db74">&#34;$50,000&#34;</span>,     <span style="color:#75715e"># å¿«é€Ÿæ•…éšœå®šä½å’Œä¿®å¤</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;åŸ¹è®­æˆæœ¬é™ä½&#34;</span>: <span style="color:#e6db74">&#34;$25,000&#34;</span>,     <span style="color:#75715e"># é™ä½æ–°å‘˜å·¥åŸ¹è®­æˆæœ¬</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;APIè°ƒç”¨æˆæœ¬&#34;</span>: <span style="color:#e6db74">&#34;$8,000&#34;</span>,       <span style="color:#75715e"># Gemini 2.5 Flashæˆæœ¬ä¼˜åŠ¿</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;æ€»è®¡èŠ‚çº¦&#34;</span>: <span style="color:#e6db74">&#34;$263,000&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="-æºç ä¸å‚è€ƒèµ„æº">ğŸ”— æºç ä¸å‚è€ƒèµ„æº</h2>
<ul>
<li><strong>é¡¹ç›®æºç </strong>: <a href="https://github.com/jackypanster/use-k8s-mcp">K8s MCP Agent</a></li>
<li><strong>é…ç½®ç¤ºä¾‹</strong>: <a href="https://github.com/jackypanster/use-k8s-mcp/blob/main/.env.example">.env.example</a></li>
<li><strong>æŠ€æœ¯æ–‡æ¡£</strong>: <a href="https://github.com/jackypanster/use-k8s-mcp/tree/main/doc">é¡¹ç›®æ–‡æ¡£</a></li>
<li><strong>MCPåè®®</strong>: <a href="https://modelcontextprotocol.io/">Model Context Protocol</a></li>
<li><strong>OpenRouter API</strong>: <a href="https://openrouter.ai/docs">OpenRouter Documentation</a></li>
<li><strong>Gemini API</strong>: <a href="https://aistudio.google.com/">Google AI Studio</a></li>
<li><strong>Kubernetesæ–‡æ¡£</strong>: <a href="https://kubernetes.io/docs/">K8s Official Docs</a></li>
</ul>
<hr>
<p><strong>æ€»ç»“</strong>ï¼šé€‰æ‹©Gemini 2.5 Flashä½œä¸ºK8s MCP Agentçš„æ ¸å¿ƒLLMæ˜¯ä¸€ä¸ªç»è¿‡æ·±æ€ç†Ÿè™‘çš„æŠ€æœ¯å†³ç­–ã€‚å…¶åœ¨MCPå·¥å…·è°ƒç”¨å…¼å®¹æ€§ã€å¤§ä¸Šä¸‹æ–‡å¤„ç†èƒ½åŠ›ã€æˆæœ¬æ•ˆç›Šå’Œå®‰å…¨æ€§æ–¹é¢çš„ç»¼åˆä¼˜åŠ¿ï¼Œä½¿å…¶æˆä¸ºä¼ä¸šçº§K8sè¿ç»´è‡ªåŠ¨åŒ–çš„ç†æƒ³é€‰æ‹©ã€‚é€šè¿‡åˆç†çš„é…ç½®å’Œæœ€ä½³å®è·µï¼ŒGemini 2.5 Flashèƒ½å¤Ÿä¸ºK8sè¿ç»´å¸¦æ¥é©å‘½æ€§çš„æ•ˆç‡æå‡ï¼Œå®ç°æ˜¾è‘—çš„ROIå’Œå•†ä¸šä»·å€¼ã€‚</p>
<p>å¯¹äºæ­£åœ¨è€ƒè™‘ç±»ä¼¼æŠ€æœ¯é€‰å‹çš„å›¢é˜Ÿï¼Œæˆ‘ä»¬å¼ºçƒˆæ¨èæ·±å…¥è¯„ä¼°Gemini 2.5 Flashçš„èƒ½åŠ›ã€‚å…¶åœ¨å·¥å…·è°ƒç”¨ã€å¤§ä¸Šä¸‹æ–‡å¤„ç†å’Œæˆæœ¬æ§åˆ¶æ–¹é¢çš„ä¼˜åŠ¿ï¼Œå°†ä¸ºæ‚¨çš„AIé©±åŠ¨è¿ç»´ç³»ç»Ÿå¸¦æ¥è´¨çš„é£è·ƒã€‚</p>]]></content:encoded></item></channel></rss>